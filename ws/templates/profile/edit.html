{% extends "base.html" %}
{% block head_title %}
Edit profile
{% if viewing_participant %} - {{ viewing_participant.name }} {%endif %}
{% endblock head_title %}

{% block content %}

<div id="last_updated">
{% if not viewing_participant.info_current %}
<p> Please complete the below fields. <strong>You will not be able to attend a trip until this form is completed.</strong></p>
{% else %}
<p>Last updated on {{ viewing_participant.last_updated }}</p>
{% endif %}
</div>

<form name="{{ participant_form.form_name }}" action="" method="post" novalidate>
    {% csrf_token %}
    <div class="row">
        <div class="col-sm-6">
            <h4 id="personal_info">Personal info</h4>
            {{ participant_form.as_div }}
        </div>
        <div class="col-sm-6">
            <h4 id="car">Do you have a car?
                <div class="btn-group" role="group" data-ng-init="{{ has_car_checked|yesno:"car.owner=true,car.owner=false," }}" data-ng-required>
                    <label class="btn" data-ng-model="car.owner" data-ng-class="car.owner ? 'btn-primary' : 'btn-default'" data-uib-btn-radio="true">Yes</label>
                    <label class="btn" data-ng-model="car.owner" data-ng-class="car.owner === false ? 'btn-primary' : 'btn-default'" data-uib-btn-radio="false">No</label>
                </div>
                <input class="ng-hide" type="checkbox" name="has_car" data-ng-checked="car.owner">
            </h4>
            <div data-ng-switch="car.owner" data-ng-cloak>
                <div data-ng-switch-when="true">
                    {{ car_form.as_div }}
                </div>
                <p data-ng-switch-when="false">
                If you ever rent a car for a trip, please come back here and
                tell us about it!
                </p>
                <p data-ng-switch-default>
                If you do, please let us know!
                You'll never be under any obligation to drive it.
                </p>
            </div>
        </div>
    </div>

    <hr>

    <div class="row">
        <div class="col-sm-6">
            <h4 id="emergency_info">Emergency info</h4>
            {{ emergency_info_form.as_div }}
        </div>

        <div class="col-sm-6">
            <h4 id="emergency_contact">Emergency contact</h4>
            {{ emergency_contact_form.as_div }}
        </div>
    </div>

    <button type="submit" data-ng-disabled="{{ participant_form.form_name }}.$invalid || !car.hasOwnProperty('owner')" class="btn btn-primary">Submit</button>
</form>
{% endblock content %}
