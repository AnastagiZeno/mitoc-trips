{% extends "messages_page.html" %}

{% block content %}
{{ block.super }}

{% if not formset.total_form_count %}
<p> No trips found!
Once <a href="{% url 'leaders' %}">leaders</a> have
<a href="{% url 'add_trip' %}">created trips,</a>
they will appear here.</p>
{% else %}
<form action="" method="post">
    {% csrf_token %}
    <table class="footable">
        {{ formset.management_form }}
        <thead>
            <tr>
                <th>Name</th>  {# Link out #}
                <th data-hide="phone">Level</th>
                <th data-hide="phone">Leaders</th>
                <th data-hide="phone" data-type="numeric">Date</th>
                <th class="nowrap">Approved</th>
                {% if formset.is_bound and not formset.is_valid %}
                <th class="error" data-sort-ignore="true">Errors</th>
                {% endif %}
            </tr>
        </thead>

        <tbody>
        {% for form in formset %}

        {{ form.id }} {# hidden id #}
            <tr>
                <td>  <a href="{% url 'view_trip' form.instance.id %}">{{ form.instance.name }}</a></td>
                <td>{{ form.instance.level }}</td>
                <td>{% for leader in form.instance.leaders.all %}
                    <a href="{% url 'view_participant' leader.id %}">{{ leader }}</a>{% if not forloop.last %}, {% endif %}{% endfor %}
                </td>
                <td class="nowrap" data-value="{{ form.instance.trip_date|date:'U' }}"> {{ form.instance.trip_date|date:"Y-m-d" }}</td>
                <td data-value="{{ form.instance.wsc_approved }}"> {{ form.wsc_approved }}</td>
                {% if formset.errors %}
                <td> {{ form.errors }}</td>
                {% endif %}
            </tr>

        {% endfor %}
        </tbody>
    </table>
    <button type="submit" class="btn btn-primary">Submit</button>
</form>
{% endif %}
{% endblock content %}
