{% extends "messages_page.html" %}
{% load signup_tags %}

{% block head_title %}{{ trip.name }}{% endblock head_title %}

{% block content %}
{{ block.super }}

{% if is_chair %}
  <h4>Activity chair functions</h4>
  <div class="btn-group" role="group">
    <a type="button" class="btn btn-default" href="{% url 'trip_medical' trip.id %}"><i class="fa fa-medkit"></i>&nbsp;WIMP info</a>
    <a type="button" class="btn btn-default" href="{% url 'edit_trip' trip.id %}"   ><i class="fa fa-edit"  ></i>&nbsp;Edit</a>
    <a type="button" class="btn btn-default" href="{% url 'admin_trip' trip.id %}"  ><i class="fa fa-wrench"></i>&nbsp;Admin</a>
  </div>
  <delete class="pull-right" data-api-slug="trips" data-obj-id="{{ trip.id }}"></delete>
{% endif %}

{% trip_summary trip %}

{% signup_for_trip trip viewing_participant participant_signup %}


{% if user.is_authenticated %}
  <hr>

  {% if has_notes or participant.is_leader %} {# Table is only for drivers/notes (can hide without) #}
    <h3>Leaders ({{ trip.leaders.count }})</h3>
    {% signup_table leader_signups has_notes show_drivers=participant.is_leader all_participants=trip.leaders%}
  {% endif %}

  {% if signups_on_trip %}
    <h3>Participants ({{ signups_on_trip.count }} / {{ trip.maximum_participants }})</h3>
    {% signup_table signups_on_trip has_notes show_drivers=participant.is_leader %}

    <h5>Email all participants</h5>
    <pre class="participant-emails">{% for signup in signups_on_trip %}{{ signup.participant.email_addr }}{% if not forloop.last %}, {% endif %}{% endfor %}</pre>
  {% endif %}

  {% if waitlist_signups %}
    <h3>Waiting List ({{ waitlist_signups.count }}) </h3>
    {% signup_table waitlist_signups has_notes show_drivers=participant.is_leader %}
  {% endif %}

  {% if signups %}
    <hr>
    <h3>All Participant Signups</h3>
    {% signup_table signups has_notes show_drivers=False %}
  {% endif %}
{% endif %}

{% endblock content %}
