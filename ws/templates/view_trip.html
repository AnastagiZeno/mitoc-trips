{% extends "base.html" %}

{% block content %}
<h3> Trip </h3>
<table>
    <tr>
        <th>Leaders:</th>
        <td>{{ trip.leaders.all|join:", " }}</td>
    </tr>
    <tr>
        <th>Name:</th>
        <td>{{ trip.name }}</td>
    </tr>
    <tr>
        <th>Description:</th>
        <td>{{ trip.description }}</td>
    </tr>
    <tr>
        <th>Trip date:</th>
        <td>{{ trip.trip_date|date:"Y-m-d" }}</td>
    </tr>
    <tr>
        <th>Leaders willing to rent:</th>
        <td>{{ trip.willing_to_rent|yesno }}</td>
    </tr>
    <tr>
        <th>Difficulty rating:</th>
        <td>{{ trip.difficulty_rating }}</td>
    </tr>
    {% if trip.prereqs %}
    <tr>
        <th>Prerequisites:</th>
        <td>{{ trip.prereqs }}</td>
    </tr>
    {% endif %}
    {% if trip.notes %}
    <tr>
        <th>Notes:</th>
        <td>{{ trip.notes }}</td>
    </tr>
    {% endif %}
</table>

<h3> Signup </h3>
<table>
    <tr>
        <th>Algorithm:</th>
        <td>{{ trip.algorithm }}</td>
    </tr>
    <tr>
        <th>Capacity:</th>
        <td>{{ trip.capacity }}</td>
    </tr>
    <tr>
        <th>Signups {{ trip.signups_open|yesno:"opened,open" }} at:</th>
        <td>{{ trip.signups_open_at }}</td>
    </tr>
    {% if trip.signups_close_at %}  {# Not all trips have a close time #}
    <tr>
        <th>Signups {{ trip.signups_closed|yesno:"closed,close" }} at:</th>
        <td>{{ trip.signups_close_at }}</td>
    </tr>
    {% endif %}
</table>


{% if trip.signups_open %}
<p>Signups are open!</p>
<form action="{% url 'trip_signup' %}" method="post">
    {% csrf_token %}
    {{ signup_form.as_p }}
    <input type="submit" value="Sign up" />
</form>
{% elif trip.signups_closed %}

<p>Signups for this trip are closed.</p>
{% else %}
<p>Signups for this trip are not yet open.</p>
{% endif %}

{% if signups %}
<h3>Participants ({{ signups|length }} / {{trip.capacity }})</h3>
<table>
    <thead>
        <tr>
            <th>Name</th>
            {% if trip.notes %}
            <th>Notes</th>
            {% endif %}
        </tr>
    </thead>

    <tbody>
    {% for signup in signups %}
    <tr>
        <td>{{ signup.participant }}</td>
        {% if trip.notes %}
        <td>{{ signup.notes }}</td>
        {% endif %}
    </tr>
    {% endfor %}
    </tbody>
</table>
{% endif %}



{% endblock content %}
